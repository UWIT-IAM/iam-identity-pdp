{% extends "base.html" %}

{% block content %}

    <div ng-app="pdpApp" class="container">

        {% if show_publish %}
            <!-- tabs for pref name and pub pref -->
            <div role="tabpanel">
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#prefname" aria-controls="prefname" role="tab"
                                                          data-toggle="tab">Preferred name</a></li>
                <li role="presentation"><a href="#pubpref" aria-controls="pubpref" role="tab" data-toggle="tab">Publish
                    pref</a></li>
            </ul>

            <div class="tab-content">

            <div role="tabpanel" class="tab-pane active" id="prefname">
        {% endif %}

        <div class="container">
            <!-- Begin legal name -->
            <div class="legalname">
                <h2>Legal Name</h2>
                <!-- The system should grab the legal name data from the db, and in the UI it is not editable to the user -->
                <p>{{ irws_name.formal_fname }} {{ irws_name.formal_lname }}</p>
            </div>
            <!-- End legal name -->
            {% verbatim %}
            <div ng-cloak ng-controller="NameCtrl"
                 ng-model-options="{ allowInvalid: true }">
                <div class="preferred-name">
                    <h2>Preferred Name</h2>
                     <p>You can set a preferred name to be used in place of your legal name wherever possible. If you are listed in the <a href=
                        "http://www.washington.edu/home/peopledir/" target="_blank">UW directory</a>, your preferred name will be visible there immediately. In the future, your preferred name will appear in more places including Outlook and Sharepoint. There is a limit of 80 characters for all three names.</p>
                </div>
                <form role="form" name="pnform">
                    <div id="fieldset_wrapper">
                        <fieldset>
                            <legend><b>Set Your Preferred Name</b></legend>
                            <div class="row">
                                <div class="col-md-4 namefield">
                                    <label for="pnfname">First Name</label>
                                    <input type="text" name="pnfname" ng-model="pn.display_fname"
                                           ng-pattern="valid_chars" value="{{wp.fname}}"
                                           maxlength="{{ displayNameMax - (displayName.length - pn.display_fname.length)  }}"
                                           required="required"/>

                                    <p id="errormessage"
                                       ng-show="pnform.pnfname.$dirty && pnform.pnfname.$error.required">First name is
                                        required.</p>
                                </div>
                                <div class="col-md-4 namefield">
                                    <label for="pnmname">Middle Name</label>
                                    <input type="text" name="pnmname" ng-model="pn.display_mname"
                                           ng-pattern="valid_chars"
                                           maxlength="{{ displayNameMax - (displayName.length - pn.display_mname.length)  }}"
                                           value="{{wp.mname}}"/>
                                </div>
                                <div class="col-md-4 namefield">
                                    <label for="pnlname">Last Name</label>
                                    <input type="text" name="pnlname" ng-model="pn.display_lname"
                                           ng-pattern="valid_chars" value="{{wp.lname}}"
                                           maxlength="{{ displayNameMax - (displayName.length - pn.display_lname.length)  }}"
                                           required="required"/>

                                    <p id="errormessage"
                                       ng-show="pnform.pnlname.$dirty && pnform.pnlname.$error.required">Last name is
                                        required.</p>
                                </div>
                            </div>
                            <p id="errormessage" ng-show="pnform.$dirty && pnform.$error.pattern">The following characters are
                                not allowed: {{ displayName | invalid_chars : valid_chars }}</p>
                        </fieldset>
                        <input type="hidden" name="pndn" ng-model="displayName" maxlength="{{ displayNameMax }}"/>
                                                   <!-- Counter for character -->
                        <div id="char-counter" class="alert alert-{{
                                displayName.length < displayNameMax - 10 ? 'info'
                                : displayName.length <= displayNameMax ? 'warning'
                                : 'danger'}}">
                            <p><b>Characters remaining</b> for preferred name: <b>{{ displayNameMax >= displayName.length ? displayNameMax - displayName.length : 0 }}</b> </p>
                        </div>
                    </div>
                    <!-- Begin policy -->
                    <div class="policy">
                        <h2>Terms & Conditions</h2>
                        <p>When you save your preferred name, you agree that:</p>
                        <ul>
                            <li>You have not set a preferred name with an intent to impersonate someone else, to deceive, or
                                to defraud;
                            </li>
                            <li>You understand that hate speech, inappropriate language, or repeated frequent use of this
                                feature may bar you from using this feature, at the University's discretion;
                            </li>
                            <li>You give permission for your preferred name to be used in any UW system.
                            </li>
                        </ul>

                        


                    </div>
                    <!-- End policy -->

                    <!-- Two actionable buttons -->
                    <div class="save-message">
                        <p ng-show="putStatus == 'success' && pnform.$pristine" class="save-success alert alert-success" role="alert">
                            Your name has been saved.
                        </p>

                        <p ng-show="putStatus == 'error'" class="save-failure alert alert-error" role="alert">
                            Error trying to save name.
                        </p>
                    </div>

                    <button type="submit" id="save" class="btn btn-primary" ng-click="putPrefName()"
                            ng-disabled="pnform.$invalid || pnform.$pristine"
                            >Agree & Save Name
                    </button>

                </form>
            </div>

            {% endverbatim %}
            {% if show_publish %}
                </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="pubpref">
                    <tab heading="Pub pref" active="false" disabled="">
                        <!-- <h2><div>Publish preference</h2> -->
                        <p>You can set publishing...</p>
                        {% verbatim %}
                        <div ng-controller="PubCtrl">
                            <form role="form">
                                <div class="form-group">
                                    <label for="wppublish">Publish in UW Directory?</label>
                                    <br/>
                                    <input type="radio" id="wppubyes" name="wppub" value="yes" ng-model="wp_publish">
                                    <label for="wppubyes">Yes</label>
                                    <br/>
                                    <input type="radio" id="wppubno" name="wppub" value="no" ng-model="wp_publish">
                                    <label for="wppubno">No</label>
                                </div>
                            </form>
                            <a class="btn btn-primary" ng-click="putPubPref()">
                                Save
                            </a>
                            <span ng-hide="putPubStatus == null">{{putPubStatus}}</span>
                        </div>
                        {% endverbatim %}
                    </tab>
                </div>
                </div>
                </div>
            {% endif %}
    </div>
{% endblock %}


