{% extends "base.html" %}

{% block content %}

    <div ng-app="pdpApp" ng-cloak class="container">

        {% if show_publish %}
            <!-- tabs for pref name and pub pref -->
            <div role="tabpanel">
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation"><a href="#prefname" aria-controls="prefname" role="tab"
                                                          data-toggle="tab">Preferred name</a></li>
                <li role="presentation" class="active"><a href="#pubpref" aria-controls="pubpref" role="tab" data-toggle="tab">Employee publish
                    preference</a></li>
            </ul>

            <div class="tab-content">

            <div role="tabpanel" class="tab-pane" id="prefname">
        {% endif %}

        <div class="container">
            <!-- Begin legal name -->
            <div class="legalname">
                <h2>Legal Name</h2>
                <!-- The system should grab the legal name data from the db, and in the UI it is not editable to the user -->
                <p>{{ irws_name.formal_fname }} {{ irws_name.formal_lname }}</p>
            </div>
            <!-- End legal name -->
            {% verbatim %}
            <div ng-cloak ng-controller="NameCtrl as name"
                 ng-model-options="{ allowInvalid: true }">
                <div class="preferred-name">
                    <h2>Preferred Name</h2>
                     <p>You can set a preferred name to be used in place of your legal name wherever possible. If you are listed in the <a href=
                        "http://www.washington.edu/home/peopledir/" target="_blank">UW directory</a>, your preferred name will be visible there immediately. There is a limit of 80 characters for all three names.</p>
                </div>
                <form role="form" name="name.form">
                    <div id="fieldset_wrapper">
                        <fieldset>
                            <legend><b>Set Your Preferred Name</b></legend>
                            <div class="row">
                                <div class="col-md-4 namefield">
                                    <label for="pnfname">First Name</label>
                                    <input type="text" name="pnfname" ng-model="name.pn.display_fname"
                                           ng-pattern="name.valid_chars"
                                           ng-change="name.updateDisplayName()"
                                           maxlength="{{ name.displayNameMax - (name.displayName.length - name.pn.display_fname.length)  }}"
                                           required="required"/>

                                    <p id="errormessage"
                                       ng-show="name.form.pnfname.$dirty && name.form.pnfname.$error.required">First name is
                                        required.</p>
                                </div>
                                <div class="col-md-4 namefield">
                                    <label for="pnmname">Middle Name</label>
                                    <input type="text" name="pnmname" ng-model="name.pn.display_mname"
                                           ng-pattern="name.valid_chars"
                                           ng-change="name.updateDisplayName()"
                                           maxlength="{{ name.displayNameMax - (name.displayName.length - name.pn.display_mname.length)  }}"/>
                                </div>
                                <div class="col-md-4 namefield">
                                    <label for="pnlname">Last Name</label>
                                    <input type="text" name="pnlname" ng-model="name.pn.display_lname"
                                           ng-change="name.updateDisplayName()"
                                           ng-pattern="name.valid_chars"
                                           maxlength="{{ name.displayNameMax - (name.displayName.length - name.pn.display_lname.length)  }}"
                                           required="required"/>

                                    <p id="errormessage"
                                       ng-show="name.form.pnlname.$dirty && name.form.pnlname.$error.required">Last name is
                                        required.</p>
                                </div>
                            </div>
                            <p id="errormessage" ng-show="name.form.$dirty && name.form.$error.pattern">The following characters are
                                not allowed: {{ name.displayName | invalid_chars : name.valid_chars }}</p>
                        </fieldset>
                        <input type="hidden" name="pndn" ng-model="name.displayName" maxlength="{{ name.displayNameMax }}"/>
                                                   <!-- Counter for character -->
                        <div id="char-counter" class="alert alert-{{ name.displayCharsRemaining > 10 ? 'info'
                                : name.displayCharsRemaining >= 0 ? 'warning' : 'danger'}}">
                            <p><b>{{ name.displayCharsRemaining >= 0 ? name.displayCharsRemaining : 0 }} character{{ name.displayCharsRemaining  == 1 ? '' : 's'}}
                                remaining</b> for preferred name</p>
                        </div>
                    </div>
                    <!-- Begin policy -->
                    <div class="policy">
                        <h2>Terms & Conditions</h2>
                        <p>When you save your preferred name, you agree that:</p>
                        <ul>
                            <li>You have not set a preferred name with an intent to impersonate someone else, to deceive, or
                                to defraud;
                            </li>
                            <li>You understand that hate speech, inappropriate language, or repeated frequent use of this
                                feature may bar you from using this feature, at the University's discretion;
                            </li>
                            <li>You give permission for your preferred name to be used in any UW system.
                            </li>
                        </ul>

                        


                    </div>
                    <!-- End policy -->

                    <!-- Two actionable buttons -->
                    <div class="save-message">
                        <p ng-show="name.putStatus == 'success' && name.form.$pristine" class="save-success alert alert-success" role="alert">
                            Your name has been saved.
                        </p>

                        <p ng-show="name.putStatus == 'error'" class="save-failure alert alert-danger" role="alert">
                            Error trying to save name.
                        </p>
                    </div>

                    <button type="submit" id="save" class="btn btn-primary" ng-click="name.putPrefName()"
                            ng-disabled="name.form.$invalid || name.form.$pristine"
                            >Agree & Save Name
                    </button>

                </form>
            </div>

            {% endverbatim %}
            {% if show_publish %}
                </div>
                </div>

                <div role="tabpanel" class="tab-pane active" id="pubpref">
                    <tab heading="Pub pref" active="false" disabled="">
                        {% verbatim %}
                        <div ng-controller="PubCtrl as pub">
                            <form role="form" name="pub.form">
                                <div class="form-group">
                                    <label>Publish in UW Directory?</label>
                                    <br/>
                                    <label>
                                        <input type="radio" value="no" ng-model="pub.publish.publish">
                                        Do not publish
                                    </label><br/>
                                    <label>
                                        <input type="radio" value="yes" ng-model="pub.publish.publish">
                                        Publish
                                    </label><br/>
                                    <label>
                                        <input type="radio" value="no email" ng-model="pub.publish.publish">
                                        Publish, without email
                                    </label><br/>
                                </div>
                            </form>
                            <div class="save-message">
                                <p ng-show="pub.putStatus == 'success' && pub.form.$pristine" class="save-success alert alert-success" role="alert">
                                    Your publishing preferences have been saved.</p>
                                <p ng-show="putStatus == 'error'" class="save-failure alert alert-danger" role="alert">
                                    Error trying to publishing preferences.</p>
                            </div>
                            <button type="submit" id="save" class="btn btn-primary" ng-click="pub.putPubPref()"
                                ng-disabled="pub.form.$invalid || pub.form.$pristine">
                                Save Preferences</button>
                        </div>
                        {% endverbatim %}
                    </tab>
                </div>
                </div>
                </div>
            {% endif %}
    </div>
{% endblock %}


